--- src/ChkTypEv.c	2010-09-22 03:25:24.000000000 +0200
+++ src/ChkTypEv.c	2010-12-10 17:48:20.000000000 +0100
@@ -57,6 +57,7 @@
 		if (qelt->event.type == type) {
 		    *event = qelt->event;
 		    _XDeq(dpy, prev, qelt);
+                    _XStoreEventCookie(dpy, event);
 		    UnlockDisplay(dpy);
 		    return True;
 		}
